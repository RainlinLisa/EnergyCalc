<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Document</title>
	<link rel="stylesheet" href="styleCss.css">
</head>

<body>
 <div id="app">
	<div class="container">
	<h1>Энергосбережение</h1>
	</div>
	
	<div class="container">
		<div class="row">
			<div class="col-1-3">
				<ul>
				   <li>Количество ламп, шт.</li>
				   <li>Количество часов работы ламп в год</li>
				   <li>Стоимость электроэнергии - 1 кВт*ч, руб.</li>
				</ul>		
			</div>
			
			<div class="col-2-3">
				<ul>
				   <li><input type="integer" v-model.number="quantityLamp" v-on:keypress="onlyInteger"></li>
				   <li><input type="integer" v-model="hrYear" v-on:keypress="onlyInteger"></li>
				   <li><input type="integer" v-model.number="costEnergy" v-on:keypress="onlyFloat"></li>
				</ul>	
			</div>
		</div>
    </div>
	
	<div class="row">
		<div class="col-1-4">
			<ul>
				<li>(Тип лампы)</li>
			   <li>Мощность лампы, Вт</li>
			   <li>Суммарная мощность ламп, Вт</li>
			   <li>Потребляемая электроэнергия за год, кВт*час</li>
			   <li>Срок службы ламп, часов</li>
			   <li>Цена за лампу, руб.</li>
			   <li>Первоначальные инвестиции на покупку ламп, руб.</li>
			</ul>
		</div>
		<div class="col-1-4">
			<ul>
				<li>накаливания</li>
			    <li>		
					<select v-model="selectedPowerNacal">
						<option v-for="option in optionsNacal" v-bind:value="option.value">
							{{ option.text }}
						</option>
					</select>
					<span>(Выбрано: {{ selectedPowerNacal }})</span>
			    </li>
			    <li style="font-weight: bold; color: red;"> {{ powerLamp }}</li>
			    <li> <input type="edit" disabled value="{{ powerYear }}"></input></li>
			    <li><input type="integer" v-model.number="lifeTimeNakal" v-on:keypress="onlyFloat"></li>
			    <li><input type="integer" v-model.number="costLampNakal" v-on:keypress="onlyFloat"></li>
			    <li>Первоначальные инвестиции на пjtокупку ламп, руб.</li>
			</ul>
		</div>
		<div class="col-1-4">
			<ul>
			    <li>
			   	<li>люминесцентная</li>
					<select v-model="selectedPowerLum">
						<option v-for="option in optionsLum" v-bind:value="option.value">
							{{ option.text }}
						</option>
					</select>
					<span>(Выбрано: {{ selectedPowerLum }})</span>
			    </li>
			    <li>Суммарная мощность ламп, Вт</li>
			    <li>Потребляемая электроэнергия за год, кВт*час</li>
			    <li><input type="integer" v-model.number="lifeTimeLum" v-on:keypress="onlyFloat"></li>
			    <li><input type="integer" v-model.number="costLampLum" v-on:keypress="onlyFloat"></li>
			    <li>Первоначальные инвестиции на покупку ламп, руб.</li>
			</ul>
		</div>
		<div class="col-1-4">
			<ul>
			   <li>
			   	<li>светодиодная</li>
					<select v-model="selectedPowerSvet">
						<option v-for="option in optionsSvet" v-bind:value="option.value">
							{{ option.text }}
						</option>
					</select>
					<span>(Выбрано: {{ selectedPowerSvet }})</span>
			    </li>
			    <li>Суммарная мощность ламп, Вт</li>
			    <li>Потребляемая электроэнергия за год, кВт*час</li>
			    <li><input type="integer" v-model.number="lifeTimeSvet" v-on:keypress="onlyFloat"></li>
			    <li><input type="integer" v-model.number="costLampSvet" v-on:keypress="onlyFloat"></li>
			    <li>Первоначальные инвестиции на покупку ламп, руб.</li>
			</ul>
		</div>
    </div>
	
	<input v-model="lifeTimeNakal" readonly>
	

	<!-- придумать как вводить только положительные числа с двумя знаками после запятой 
	     (запятая только одна придумать чтобы русские точки и запятые менялись на нужную точку) -->

	
	<!-- Выбор мощности ламп -->
 </div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.4.0/vue.js"></script>
	
<script>
	new Vue({
		el: '#app',
		data: {
			quantityLamp: '',
			hrYear: '',
			costEnergy: '',
			
			lifeTimeNakal: '1000.00',
			costLampNakal: '20',			
			selectedPowerNacal: '40',
			optionsNacal: [
			  { text: '40', value: 40 },
			  { text: '60', value: 60 },
			  { text: '75', value: 75 },
			  { text: '100', value: 100 }
			],
			lifeTimeLum: '8000.00',
			costLampLum: '90',
			selectedPowerLum: '12',
			optionsLum: [
			  { text: '12', value: 12 },
			  { text: '15', value: 15 },
			  { text: '18', value: 18 },
			  { text: '20', value: 20 }
			],
			lifeTimeSvet: '20000.00',
			costLampSvet: '120',
			selectedPowerSvet: '8',
			optionsSvet: [
			  { text: '8', value: 8 },
			  { text: '10', value: 10 },
			  { text: '12', value: 12 },
			  { text: '15', value: 15 }
			]
		},
		computed: { 
			computedAll: function() {
				return (this.quantityLamp && this.hrYear && this.costEnergy)
			},
			powerLamp: function () {
				if (this.computedAll) {
					return this.quantityLamp * this.selectedPowerNacal
				}
			},			
			powerYear: function () {
				if (this.computedAll) {
					return ((this.hrYear * this.selectedPowerNacal)/1000).toFixed(2)
				}
			},
			costEnergyYear: function () {
				if (this.computedAll) {
					return (this.powerYear * this.costEnergy).toFixed(2)
				}
			}
		},
		methods: {	
			onlyFloat: function(evt) {
				var regex = new RegExp("^[0-9]+[.,]?[0-9]{0,2}$");
				var key = String.fromCharCode(!evt.charCode ? evt.which : evt.charCode);
				var s = evt.srcElement.value + key;
				evt.srcElement.value = evt.srcElement.value.replace(",", ".");
				if (!regex.test(s)) {
					event.preventDefault();
					return false;
				}
			},
			onlyInteger: function(evt) {
				var regex = new RegExp("^[0-9]+$");
				var key = String.fromCharCode(!evt.charCode ? evt.which : evt.charCode);
				var s = evt.srcElement.value + key;
				if (!regex.test(s)) {
					event.preventDefault();
					return false;
				}
			}
		}
	})
</script>
</body>
</html>	
